<!DOCTYPE html>
<html>

<head>
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <title>AdminDesigns - A Responsive HTML5 Admin UI Framework</title>
    <meta name="keywords" content="HTML5 Bootstrap 3 Admin Template UI Theme"/>
    <meta name="description" content="AdminDesigns - A Responsive HTML5 Admin UI Framework">
    <meta name="author" content="AdminDesigns">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Font CSS (Via CDN) -->
    <link rel='stylesheet' type='text/css' href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700'>

    <!-- Theme CSS -->
    <link rel="stylesheet" type="text/css" href="assets/skin/default_skin/css/theme.css">
    <link rel="stylesheet" type="text/css" href="assets/skin/default_skin/css/theme2.css">
    <link rel="stylesheet" type="text/css" href="assets/skin/default_skin/css/theme3.css">

    <!-- Admin Forms CSS -->
    <link rel="stylesheet" type="text/css" href="assets/admin-tools/admin-forms/css/admin-forms.css">

    <!-- Favicon -->
    <link rel="shortcut icon" href="assets/img/favicon.ico">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
    <style>
        .errormessage{
            width: 100%;
            text-align: center;
            height: 20px;
            display:block;
            margin-top: 10px;
            color: red;
            font-size: 16px;
            position: relative;
        }
    </style>
</head>

<body class="external-page external-alt sb-l-c sb-r-c">

<!-- Start: Main -->
<div id="main" class="animated fadeIn">

    <!-- Start: Content-Wrapper -->
    <section id="content_wrapper">

        <!-- Begin: Content -->
        <section id="content">

            <div class="admin-form theme-info mw500" id="login">

                <!-- Login Panel/Form -->
                <div class="panel mt30 mb25">

                    <form method="post" action="http://localhost:2900/login" id="contact">
                        <div class="panel-body bg-light p25 pb15">
                            <!-- Username Input -->
                            <div class="section">
                                <label for="username" class="field-label text-muted fs18 mb10">用户名</label>
                                <label for="username" class="field prepend-icon">
                                    <input type="text" name="username" id="username" class="gui-input"
                                           placeholder="请输入用户名">
                                    <label for="username" class="field-icon">
                                        <i class="fa fa-user"></i>
                                    </label>
                                </label>
                                <span class="errormessage usernameerr">*用户名必须为6~16，由字符数字组成*</span>
                            </div>

                            <!-- Password Input -->
                            <div class="section">
                                <label for="username" class="field-label text-muted fs18 mb10">密码</label>
                                <label for="password" class="field prepend-icon">
                                    <input type="password" name="password" id="password" class="gui-input"
                                           placeholder="请输入密码">
                                    <label for="password" class="field-icon">
                                        <i class="fa fa-lock"></i>
                                    </label>
                                </label>
                                <span class="errormessage passworderr">*密码必须为6~16，由字符数字组成*</span>
                                <span id="error" class="errormessage">密码错误</span>
                            </div>

                        </div>

                        <div class="panel-footer clearfix">
                            <button id="signin" class="button btn-primary mr10 pull-right">登录</button>
                            <label class="switch ib switch-primary mt10">
                                <input type="checkbox" name="remember" id="remember" checked>
                                <label for="remember" data-on="YES" data-off="NO"></label>
                                <span>记住我</span>
                            </label>
                        </div>

                    </form>
                </div>

                <!-- Registration Links -->
                <div class="login-links">
                    <p>
                        <a href="pages_login-alt.html" class="active" title="Sign In">忘记密码?</a>
                    </p>
                    <p>还没有注册
                        <a href="register.html" title="Sign In">点击这里注册</a>
                    </p>
                </div>

                <!-- Registration Links(alt) -->
                <div class="login-links hidden">
                    <a href="#" class="active" title="Sign In">登录</a> |
                    <a href="#" class="" title="Register">注册</a>
                </div>

            </div>

        </section>
        <!-- End: Content -->

    </section>
    <!-- End: Content-Wrapper -->
    <span class="errormessage err1">*表单项不能为空*</span><br>

</div>
<!-- End: Main -->


<!-- BEGIN: PAGE SCRIPTS -->

<!-- jQuery -->
<script src="vendor/jquery/jquery-1.11.1.min.js"></script>
<script src="vendor/jquery/jquery_ui/jquery-ui.min.js"></script>

<!-- Theme Javascript -->
<script src="assets/js/utility/utility.js"></script>
<script src="assets/js/demo/demo.js"></script>
<script src="assets/js/main.js"></script>

<!-- Page Javascript -->
<script type="text/javascript">
    jQuery(document).ready(function () {

        "use strict";

        // Init Theme Core
        Core.init();

        // Init Demo JS
        Demo.init();

    });
    $('.errormessage').hide();
    $('#username').blur(function () {
        var usernameREGEXP = /^[a-zA-Z0-9_]{5,16}$/; //用户名只能为大小写字母，数字且在6——17之间
        var username = $('#username').val();
        if(!usernameREGEXP.test(username)){
            $('.usernameerr').show();
        }
        $(this).focus(function () {
            $('.errormessage').hide();
        })
    })
    $('#password').blur(function () {
        var passwordREGEXP = /^[a-zA-Z]\w{5,17}$/;  //密码必须为数字，字符，下划线，且在6——18位之间
        var password = $('#password').val();
        if(!passwordREGEXP.test(password)){
            $('.passworderr').show();
        }
        $(this).focus(function () {
            $('.errormessage').hide();
        })
    })
    $('#signin').click(function () {
        var url ="http://localhost:2900/login";
        var username = $('#username').val();
        var password = $('#password').val();
        var usernameREGEXP = /^[a-zA-Z0-9_]{5,16}$/; //用户名只能为大小写字母，数字且在6——17之间
        var passwordREGEXP = /^[a-zA-Z]\w{5,17}$/;  //密码必须为数字，字符，下划线，且在6——18位之间
        if(username&&password){
            if(usernameREGEXP.test(username)&&passwordREGEXP.test(password)){
                $.getJSON(url,{"username":username,"password":password},function (data) {
                    console.log(data);
                    if(data.toString()){
                        var user_type = data[0].user_type;
                        if(user_type == "user"){
                            console.log("用户登录");
                            window.username = username;
                            window.passsword = password;
                            location.assign("http://localhost:3000?username="+username);
                        }else if(user_type == "admin"){
                            console.log("管理员登录")
                            location.assign("./datebaseEdit.html")
                        }
                    }else{
                        $("#error").show();
                    }
                })
            }else{
                alert("请检查表单项");
            }
        }else{
            $('.err1').show();
        }

    })
</script>

<!-- END: PAGE SCRIPTS -->

</body>

</html>
